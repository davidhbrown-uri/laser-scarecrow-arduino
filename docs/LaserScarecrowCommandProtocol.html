<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ul.lst-kix_c7ifzwx41atq-1{list-style-type:none}.lst-kix_9f9cvv156ekv-8>li:before{content:"\0025a0  "}ul.lst-kix_c7ifzwx41atq-0{list-style-type:none}ul.lst-kix_c7ifzwx41atq-5{list-style-type:none}.lst-kix_9f9cvv156ekv-6>li:before{content:"\0025cf  "}ul.lst-kix_c7ifzwx41atq-4{list-style-type:none}ul.lst-kix_c7ifzwx41atq-3{list-style-type:none}.lst-kix_9f9cvv156ekv-5>li:before{content:"\0025a0  "}.lst-kix_9f9cvv156ekv-7>li:before{content:"\0025cb  "}ul.lst-kix_c7ifzwx41atq-2{list-style-type:none}ul.lst-kix_c7ifzwx41atq-8{list-style-type:none}ul.lst-kix_c7ifzwx41atq-7{list-style-type:none}ul.lst-kix_c7ifzwx41atq-6{list-style-type:none}ul.lst-kix_9f9cvv156ekv-2{list-style-type:none}ul.lst-kix_9f9cvv156ekv-3{list-style-type:none}ul.lst-kix_9f9cvv156ekv-0{list-style-type:none}ul.lst-kix_9f9cvv156ekv-1{list-style-type:none}.lst-kix_c7ifzwx41atq-1>li:before{content:"\0025cb  "}.lst-kix_c7ifzwx41atq-2>li:before{content:"\0025a0  "}ul.lst-kix_9f9cvv156ekv-8{list-style-type:none}ul.lst-kix_9f9cvv156ekv-6{list-style-type:none}ul.lst-kix_9f9cvv156ekv-7{list-style-type:none}.lst-kix_c7ifzwx41atq-0>li:before{content:"\0025cf  "}ul.lst-kix_9f9cvv156ekv-4{list-style-type:none}ul.lst-kix_9f9cvv156ekv-5{list-style-type:none}.lst-kix_c7ifzwx41atq-7>li:before{content:"\0025cb  "}.lst-kix_c7ifzwx41atq-5>li:before{content:"\0025a0  "}.lst-kix_c7ifzwx41atq-6>li:before{content:"\0025cf  "}.lst-kix_c7ifzwx41atq-3>li:before{content:"\0025cf  "}.lst-kix_c7ifzwx41atq-4>li:before{content:"\0025cb  "}.lst-kix_9f9cvv156ekv-2>li:before{content:"\0025a0  "}.lst-kix_9f9cvv156ekv-1>li:before{content:"\0025cb  "}.lst-kix_9f9cvv156ekv-3>li:before{content:"\0025cf  "}.lst-kix_9f9cvv156ekv-0>li:before{content:"\0025cf  "}.lst-kix_9f9cvv156ekv-4>li:before{content:"\0025cb  "}.lst-kix_c7ifzwx41atq-8>li:before{content:"\0025a0  "}ol{margin:0;padding:0}table td,table th{padding:0}.c7{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:62.2pt;border-top-color:#000000;border-bottom-style:solid}.c5{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:186.8pt;border-top-color:#000000;border-bottom-style:solid}.c23{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:261pt;border-top-color:#000000;border-bottom-style:solid}.c19{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:63pt;border-top-color:#000000;border-bottom-style:solid}.c18{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:60pt;border-top-color:#000000;border-bottom-style:solid}.c13{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:164.2pt;border-top-color:#000000;border-bottom-style:solid}.c15{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:162.8pt;border-top-color:#000000;border-bottom-style:solid}.c26{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:69.8pt;border-top-color:#000000;border-bottom-style:solid}.c25{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:183pt;border-top-color:#000000;border-bottom-style:solid}.c32{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:165pt;border-top-color:#000000;border-bottom-style:solid}.c33{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:162pt;border-top-color:#000000;border-bottom-style:solid}.c30{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:60.8pt;border-top-color:#000000;border-bottom-style:solid}.c22{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:180pt;border-top-color:#000000;border-bottom-style:solid}.c36{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:76.5pt;border-top-color:#000000;border-bottom-style:solid}.c39{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:183.8pt;border-top-color:#000000;border-bottom-style:solid}.c31{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:56.2pt;border-top-color:#000000;border-bottom-style:solid}.c16{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:75pt;border-top-color:#000000;border-bottom-style:solid}.c37{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Arial";font-style:normal}.c40{color:#434343;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c41{color:#666666;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:15pt;font-family:"Arial";font-style:normal}.c24{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Arial";font-style:normal}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c42{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:italic}.c20{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:20pt;font-family:"Arial";font-style:normal}.c14{color:#000000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c4{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c44{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c35{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;text-align:left}.c8{padding-top:20pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;text-align:left}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left;height:11pt}.c34{padding-top:0pt;padding-bottom:16pt;line-height:1.15;page-break-after:avoid;text-align:left}.c29{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;text-align:left}.c17{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;text-align:left}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c11{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c9{border-spacing:0;border-collapse:collapse;margin-right:auto}.c38{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c3{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;text-decoration:line-through}.c28{margin-left:72pt;padding-left:0pt}.c12{margin-left:36pt;padding-left:0pt}.c43{color:inherit;text-decoration:inherit}.c21{padding:0;margin:0}.c10{height:0pt}.c27{font-weight:700}.c6{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c38"><p class="c17 title" id="h.svx5hly7fjs4"><span class="c37">Laser Scarecrow Command Protocol</span></p><p class="c34 subtitle" id="h.odshhaezgjri"><span class="c41">David H. Brown - February 19, 2018</span></p><p class="c44"><span class="c42">This document is a work-in-progress</span></p><h1 class="c8" id="h.1iwsvadao2a7"><span class="c20">Summary</span></h1><p class="c4"><span class="c2">The 2018 version of the laser scarecrow is intended to be remotely programmed using a Bluetooth serial connection. This requires specification of the messages to be sent from the programmer to the scarecrow and the responses to be sent back.</span></p><h1 class="c8" id="h.ypa7zapko0em"><span class="c20">Principles and assumptions guiding development</span></h1><ul class="c21 lst-kix_9f9cvv156ekv-0 start"><li class="c4 c12"><span class="c2">To ensure portability across devices and communications media...</span></li></ul><ul class="c21 lst-kix_9f9cvv156ekv-1 start"><li class="c4 c28"><span>all commands MUST be restricted to </span><span class="c11"><a class="c43" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/ASCII%23Printable_characters&amp;sa=D&amp;ust=1528861506587000">printable ASCII characters</a></span><span class="c2">&nbsp;(including appropriate whitespace)</span></li><li class="c4 c28"><span>all commands SHOULD be restricted to 6-bit ASCII &lsquo;67 character (i.e., upper-case letters, numbers, space, and other basic punctuation)</span></li></ul><ul class="c21 lst-kix_9f9cvv156ekv-0"><li class="c4 c12"><span class="c2">Commands MUST be &ldquo;simple&rdquo; to parse on the Arduino microcontroller</span></li></ul><ul class="c21 lst-kix_9f9cvv156ekv-1 start"><li class="c4 c28"><span class="c11"><a class="c43" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/G-code&amp;sa=D&amp;ust=1528861506588000">G-code</a></span><span>&nbsp;and the </span><span class="c11"><a class="c43" href="https://www.google.com/url?q=https://en.wikipedia.org/wiki/Hayes_command_set&amp;sa=D&amp;ust=1528861506588000">Hayes (modem) command set</a></span><span class="c2">&nbsp;are examples of simple text-based serial command protocols known to support implementation on resource-constrained hardware</span></li><li class="c4 c28"><span class="c2">The appropriate definition of &ldquo;simple&rdquo; is TBD ;-)</span></li></ul><ul class="c21 lst-kix_9f9cvv156ekv-0"><li class="c4 c12"><span class="c2">Responses could be more complex</span></li></ul><ul class="c21 lst-kix_9f9cvv156ekv-1 start"><li class="c4 c28"><span class="c2">phones/tablets have substantially more computing power</span></li><li class="c4 c28"><span class="c2">The Arduino MUST NOT be expected to build a highly structured response such as XML or even JSON.</span></li></ul><ul class="c21 lst-kix_9f9cvv156ekv-0"><li class="c4 c12"><span class="c2">Commands MUST be able to be typed by a human </span></li><li class="c4 c12"><span class="c2">Responses SHOULD be readable by a human</span></li></ul><h1 class="c8" id="h.w428b5gzqksy"><span class="c20">Design heuristics</span></h1><p class="c4"><span class="c2">Let&rsquo;s see if we/I can come up with something coherent from these ideas:</span></p><ul class="c21 lst-kix_c7ifzwx41atq-0 start"><li class="c4 c12"><span class="c2">Each command will begin with a capital letter usually followed by a code number up to three decimal digits </span></li></ul><ul class="c21 lst-kix_c7ifzwx41atq-1 start"><li class="c4 c28"><span class="c2">implementation MUST support a fourth digit for future expansion.</span></li></ul><ul class="c21 lst-kix_c7ifzwx41atq-0"><li class="c4 c12"><span class="c2">The letter should probably indicate the general sort of operation being performed</span></li><li class="c4 c12"><span class="c2">Command letters &ldquo;L&rdquo; and &ldquo;S&rdquo; (for Laser Scarecrow) also convey Load and Store, Look and Set, Listen and Send. Let&rsquo;s use these for manipulating the configuration of the scarecrow.</span></li><li class="c4 c12"><span class="c2">The code will denote a particular value bring reported or changed</span></li><li class="c4 c12"><span>Frequently issued </span><span>commands </span><span class="c2">should be given low code numbers, e.g., 2- or single-digit</span></li><li class="c4 c12"><span class="c2">Related codes should be grouped to have the same first digit</span></li><li class="c4 c12"><span class="c2">Codes Lx00 (x is some digit) should probably report all values stored under those codes</span></li><li class="c4 c12"><span class="c2">Read-only values (e.g., a sensor&rsquo;s current value) should not share a code with a writable value (e.g., a threshold for that sensor to have an effect)</span></li><li class="c4 c12"><span class="c2">Writable values should probably always be readable?</span></li><li class="c4 c12"><span class="c2">Parameter values, when needed, will be space-delimited following the code </span></li></ul><ul class="c21 lst-kix_c7ifzwx41atq-1 start"><li class="c4 c28"><span class="c2">Parameters usually will not be needed for L codes;</span></li><li class="c4 c28"><span class="c2">at least parameter one usually will be needed for S codes.</span></li></ul><ul class="c21 lst-kix_c7ifzwx41atq-0"><li class="c4 c12"><span class="c2">Numerical values SHOULD be represented as decimal integers, not floating-point</span></li><li class="c4 c12"><span class="c3">Unrecognized characters will </span><span class="c3">be ignored</span><span>&nbsp;Unrecognized characters will trigger CERROR_InvalidCharacter. However, runs of whitespace are allowed where a space is expected (i.e., before parameters and also before the letter of the command)</span></li><li class="c4 c12"><span class="c2">Commands will terminate with a newline (i.e., &ldquo;\n&rdquo;, ASCII 10, or hexadecimal 0x0A)</span></li><li class="c4 c12"><span class="c2">Responses will consist of:</span></li></ul><ul class="c21 lst-kix_c7ifzwx41atq-1 start"><li class="c4 c28"><span class="c2">If there are values to report for a code, the letter and code will be sent followed by a space those values as space-delimited decimal integers where possible and a newline</span></li><li class="c4 c28"><span class="c2">The characters &ldquo;ok&rdquo; and a newline.</span></li></ul><h1 class="c8" id="h.v8sq5r932osx"><span class="c20">Command examples</span></h1><p class="c4"><span class="c2">Send: L</span></p><p class="c4"><span class="c2">Response: ok</span></p><p class="c4 c6"><span class="c2"></span></p><p class="c4"><span class="c2">Send: L201</span></p><p class="c4"><span class="c2">Response: L201 0</span></p><p class="c4"><span class="c2">Send: S201 3</span></p><p class="c4"><span class="c2">Response: ok</span></p><p class="c4"><span class="c2">Send: L201</span></p><p class="c4"><span class="c2">Reponse: L201 3</span></p><h1 class="c8" id="h.qs3g3vcvy8no"><span class="c20">Code list</span></h1><p class="c4"><span class="c2">Use this template:</span></p><p class="c4 c6"><span class="c2"></span></p><a id="t.147ec33e8e4ae86386749860c344429226bd9a69"></a><a id="t.0"></a><table class="c9"><tbody><tr class="c10"><td class="c30" colspan="1" rowspan="1"><p class="c1"><span class="c2">Letter</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c1"><span class="c2">Code</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c1"><span class="c2">Parameters</span></p></td><td class="c5" colspan="1" rowspan="1"><p class="c1"><span class="c2">Description</span></p></td></tr><tr class="c10"><td class="c30" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c5" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td></tr></tbody></table><p class="c4 c6"><span class="c2"></span></p><h2 class="c35" id="h.k3px6zk7b99j"><span class="c24">-99: Frequently used commands</span></h2><p class="c4 c6"><span class="c2"></span></p><a id="t.ba56f49027d850979096765c60da97910775a485"></a><a id="t.1"></a><table class="c9"><tbody><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">Letter</span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c1"><span class="c2">Code</span></p></td><td class="c33" colspan="1" rowspan="1"><p class="c1"><span class="c2">Parameters</span></p></td><td class="c39" colspan="1" rowspan="1"><p class="c1"><span class="c2">Description</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L</span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c1"><span class="c2">(none)</span></p></td><td class="c33" colspan="1" rowspan="1"><p class="c1"><span class="c2">(none)</span></p></td><td class="c39" colspan="1" rowspan="1"><p class="c1"><span class="c2">Verify communications (response will be &ldquo;ok&rdquo;)</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c33" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c39" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td></tr></tbody></table><p class="c4 c6"><span class="c2"></span></p><p class="c4 c6"><span class="c2"></span></p><h2 class="c35" id="h.r11o59xm2u3c"><span class="c24">100-199: Position</span></h2><p class="c4 c6"><span class="c2"></span></p><a id="t.52f7ad2562f9d6fb26fc1ac00fb3738a736f0c84"></a><a id="t.2"></a><table class="c9"><tbody><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">Letters</span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c1"><span class="c2">Code</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c2">Parameters</span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c2">Description</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L</span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c1"><span class="c2">100</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c2">Report current positions and sensors</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c14">L/S</span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c1"><span class="c14">101</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c14">[0-1023]</span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c14">stepper speed (interrupt timer) (Trimpot A0)</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L</span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c1"><span class="c2">110</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c2">Report calculated current stepper angle [0-359]</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L/S</span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c1"><span class="c2">111</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c2">[0-359]</span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c2">Stepper rotation target angle (goal; not necessarily current angle). S111 accepts larger values mod 360. </span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c14">L/S</span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c1"><span class="c14">131</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c14">[0-1023]</span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c14">Servo pitch minimum (Trimpot A1)</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c14">L/S</span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c1"><span class="c14">132</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c1"><span class="c14">[0-1023]</span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c14">Servo pitch random range (Trimpot A2)</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L</span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c1"><span class="c2">150</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c2">Is tape currently sensed? [0-1] </span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L</span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c1"><span class="c2">151</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c2">Raw tape sensor reading [0-1023]</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L</span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c1"><span class="c2">159</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c2">Was tape detected at last tape calibration run [0-1]</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L</span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c1"><span class="c2">160</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c2">Is magnet sensed? [0-1]</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L</span></p></td><td class="c7" colspan="1" rowspan="1"><p class="c1"><span class="c2">169</span></p></td><td class="c15" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c25" colspan="1" rowspan="1"><p class="c1"><span class="c2">Was magnet detected at last initialization run? [0-1]</span></p></td></tr></tbody></table><p class="c4 c6"><span class="c2"></span></p><h2 class="c35" id="h.kde1ltnr8g96"><span class="c24">200-299: Wake/Sleep cycle control (daylight and/or clock)</span></h2><p class="c4 c6"><span class="c2"></span></p><a id="t.43420dd1833046a5f0a862a854dfb4f06612ae5a"></a><a id="t.3"></a><table class="c9"><tbody><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">Letter</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c1"><span class="c2">Code</span></p></td><td class="c32" colspan="1" rowspan="1"><p class="c1"><span class="c2">Parameters</span></p></td><td class="c22" colspan="1" rowspan="1"><p class="c1"><span class="c2">Description</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c1"><span class="c2">200</span></p></td><td class="c32" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c22" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L/S</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c1"><span class="c2">201</span></p></td><td class="c32" colspan="1" rowspan="1"><p class="c1"><span class="c2">[0-3]</span></p></td><td class="c22" colspan="1" rowspan="1"><p class="c1"><span class="c2">cycle mode</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c1"><span class="c2">210</span></p></td><td class="c32" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c22" colspan="1" rowspan="1"><p class="c1"><span class="c2">light sensor current value [0-1023]</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L/S</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c1"><span class="c2">221</span></p></td><td class="c32" colspan="1" rowspan="1"><p class="c1"><span class="c2">[0-1023]</span></p></td><td class="c22" colspan="1" rowspan="1"><p class="c1"><span class="c2">light sensor threshold</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c1"><span class="c2">250</span></p></td><td class="c32" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c22" colspan="1" rowspan="1"><p class="c1"><span class="c2">Current real-time clock (RTC) as: &nbsp;YY-MM-DD HH:II:SS</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c14">*L/S</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c1"><span class="c2">251</span></p></td><td class="c32" colspan="1" rowspan="1"><p class="c1"><span class="c2">[0-99] [1-12] [1-31] </span></p></td><td class="c22" colspan="1" rowspan="1"><p class="c1"><span class="c2">Set current RTC year, month, and day</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c14">*L/S</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c1"><span class="c2">252</span></p></td><td class="c32" colspan="1" rowspan="1"><p class="c1"><span class="c2">[0-23] [0-59] [0-59]</span></p></td><td class="c22" colspan="1" rowspan="1"><p class="c1"><span class="c2">Set current RTC hours, minutes, seconds</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L/S</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c1"><span class="c2">261</span></p></td><td class="c32" colspan="1" rowspan="1"><p class="c1"><span class="c2">[0-23] [0-59]</span></p></td><td class="c22" colspan="1" rowspan="1"><p class="c1"><span class="c2">RTC wake time [hour] [minute]</span></p></td></tr><tr class="c10"><td class="c18" colspan="1" rowspan="1"><p class="c1"><span class="c2">L/S</span></p></td><td class="c19" colspan="1" rowspan="1"><p class="c1"><span class="c2">262</span></p></td><td class="c32" colspan="1" rowspan="1"><p class="c1"><span class="c2">[0-23] [0-59]</span></p></td><td class="c22" colspan="1" rowspan="1"><p class="c1"><span class="c2">RTC sleep time [hour] [minute]</span></p></td></tr></tbody></table><p class="c4 c6"><span class="c2"></span></p><h3 class="c29" id="h.jr1x3xfl7rqf"><span class="c40">Cycle modes</span></h3><p class="c4 c6"><span class="c2"></span></p><a id="t.d385296ccfd5e94d6031ef3073a7c00ad594c9ad"></a><a id="t.4"></a><table class="c9"><tbody><tr class="c10"><td class="c26" colspan="1" rowspan="1"><p class="c1"><span class="c2">Decimal</span></p></td><td class="c36" colspan="1" rowspan="1"><p class="c1"><span class="c2">Bit 1 (sleep)</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c1"><span class="c2">Bit 0 (wake)</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c1"><span class="c2">Behavior</span></p></td></tr><tr class="c10"><td class="c26" colspan="1" rowspan="1"><p class="c1"><span class="c2">0 (default)</span></p></td><td class="c36" colspan="1" rowspan="1"><p class="c1"><span class="c2">0</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c1"><span class="c2">0</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c1"><span class="c2">Wake at light threshold; sleep at light threshold</span></p></td></tr><tr class="c10"><td class="c26" colspan="1" rowspan="1"><p class="c1"><span class="c2">1</span></p></td><td class="c36" colspan="1" rowspan="1"><p class="c1"><span class="c2">0</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c1"><span class="c2">1</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c1"><span class="c2">Wake by RTC wake time, sleep at light threshold</span></p></td></tr><tr class="c10"><td class="c26" colspan="1" rowspan="1"><p class="c1"><span class="c2">2</span></p></td><td class="c36" colspan="1" rowspan="1"><p class="c1"><span class="c2">1</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c1"><span class="c2">0</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c1"><span class="c2">Wake at light threshold; sleep at RTC sleeptime</span></p></td></tr><tr class="c10"><td class="c26" colspan="1" rowspan="1"><p class="c1"><span class="c2">3</span></p></td><td class="c36" colspan="1" rowspan="1"><p class="c1"><span class="c2">1</span></p></td><td class="c16" colspan="1" rowspan="1"><p class="c1"><span class="c2">1</span></p></td><td class="c23" colspan="1" rowspan="1"><p class="c1"><span class="c2">Wake at RTC wake time; sleep at RTC sleep time</span></p></td></tr></tbody></table><p class="c4 c6"><span class="c2"></span></p><p class="c4"><span class="c2">The cycle mode is a bitfield: bit 0 controls when the scarecrow wakes; bit 1 controls when the scarecrow sleeps. A 0 indicates light sensor control and 1 indicates RTC control.</span></p><h1 class="c8" id="h.xnotsn7evzvo"><span class="c20">Debug codes</span></h1><p class="c4"><span class="c2">These functions may be useful when developing</span></p><p class="c4 c6"><span class="c2"></span></p><a id="t.1dad3e54cddf96ffc5c0c29a6db89d293c925d85"></a><a id="t.5"></a><table class="c9"><tbody><tr class="c10"><td class="c30" colspan="1" rowspan="1"><p class="c1"><span class="c2">Letter</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c1"><span class="c2">Code</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c1"><span class="c2">Parameters</span></p></td><td class="c5" colspan="1" rowspan="1"><p class="c1"><span class="c2">Description</span></p></td></tr><tr class="c10"><td class="c30" colspan="1" rowspan="1"><p class="c1"><span class="c2">X</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c1"><span class="c2">0</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c0"><span class="c2"></span></p></td><td class="c5" colspan="1" rowspan="1"><p class="c1"><span class="c2">Displays &ldquo;Laser Scarecrow Debug Available!&rdquo; (if this is true)</span></p></td></tr><tr class="c10"><td class="c30" colspan="1" rowspan="1"><p class="c1"><span class="c2">X</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c1"><span class="c2">1</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c1"><span>0 </span><span class="c42">(or omitted)</span></p></td><td class="c5" colspan="1" rowspan="1"><p class="c1"><span class="c2">Set this command processor (serial or BlueTooth) to normal responses</span></p></td></tr><tr class="c10"><td class="c30" colspan="1" rowspan="1"><p class="c1"><span class="c2">X</span></p></td><td class="c31" colspan="1" rowspan="1"><p class="c1"><span class="c2">1</span></p></td><td class="c13" colspan="1" rowspan="1"><p class="c1"><span>1 </span><span class="c42">(any non-zero value)</span></p></td><td class="c5" colspan="1" rowspan="1"><p class="c1"><span class="c2">Set this command processor to verbose responses</span></p></td></tr></tbody></table><h1 class="c8" id="h.ksbl1re52ivt"><span class="c20">Implementation notes</span></h1><p class="c4"><span class="c2">The initial (Feb 20) implementation of this command parser (Command.cpp) uses a simple state machine to read in each character one at a time without additional buffering. Runs of whitespace are ignored. </span></p><p class="c4 c6"><span class="c2"></span></p><p class="c4"><span class="c2">Both the code and each parameter are stored in an unsigned 16-bit integer (Arduino&rsquo;s &ldquo;word&rdquo; type), allowing values from 0 to 65535. </span></p><p class="c4 c6"><span class="c2"></span></p><p class="c4"><span class="c2">The letter of the command is stored in a char. A word stores the code; there is no provision to distinguish between no code and a code of 0.</span></p><p class="c4 c6"><span class="c2"></span></p><p class="c4"><span>An array stores the parameters and the maximum number of parameters is determined at compile-time by </span><span class="c27">#define COMMAND_PARAMETER_LIMIT 4</span><span class="c2">&nbsp;in Command.h</span></p><p class="c4"><span class="c2">&nbsp;</span></p><h1 class="c8" id="h.fkdo0wpp9gci"><span class="c20">Implemented commands</span></h1><h2 class="c35" id="h.15lwzr3t1f2"><span class="c24">MockLaserScarecrowForBluetooth-180226a.zip</span></h2><p class="c4"><span class="c2">This version has implemented the following: X0, X1, L201, S201, L221, S221</span></p><p class="c4"><span class="c2">Both Serial (USB) and Serial1 (Bluetooth) streams have independent command processors, working with the same configuration.</span></p><p class="c4 c6"><span class="c2"></span></p><p class="c4"><span class="c2">No saving of configurations is yet implemented on the Arduino; a reset or power cycle will revert the configuration back to defaults.</span></p></body></html>